<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="zend-di">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Configuration - zend-di</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../css/styles-482aa2add1.css">

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-toggle="tooltip" data-placement="bottom" title="Go to the ZF homepage"><img src="../img/zf-logo-mark.svg" height="28" alt="Zend Framework" /></a>
                <a href="..">zend-di</a>
            </span>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../intro/">Intro</a>
                    </li>
                
                
                
                    <li >
                        <a href="../quick-start/">Quick Start</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../psr-11/">PSR-11 Support</a>
</li>

                        
                            
<li class="active">
    <a href="./">Configuration</a>
</li>

                        
                            
<li >
    <a href="../injector/">Injector</a>
</li>

                        
                            
<li >
    <a href="../codegen/">Code Generator</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">v2 Documentation</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../v2/definitions/">Definitions</a>
</li>

        
            
<li >
    <a href="../v2/instance-manager/">Instance Manager</a>
</li>

        
            
<li >
    <a href="../v2/config/">Configuration</a>
</li>

        
            
<li >
    <a href="../v2/debugging-and-complex-use-cases/">Debugging And Complex Use Cases</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../cookbook/use-with-psr-containers/">Usage with PSR-11 Containers</a>
</li>

                        
                            
<li >
    <a href="../cookbook/use-with-servicemanager/">Usage with zend-servicemanager</a>
</li>

                        
                            
<li >
    <a href="../cookbook/aot-guide/">Using AoT with Expressive and zend-servicemanager</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../migration/">Migration Guide</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" class="component-toggle" data-toggle="tooltip" data-placement="bottom" title="Show component list">
                        <i class="fa fa-book"></i> Components
                    </a>
                </li>

                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li>
                        <a href="https://github.com/zendframework/zend-di">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <!-- content:begin -->
    <div id="page-top" class="container docs">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#configuration">Configuration</a></li>
        
            <li><a href="#type-preferences">Type Preferences</a></li>
        
            <li><a href="#parameters">Parameters</a></li>
        
            <li><a href="#aliases">Aliases</a></li>
        
    
    </ul>

    
    <ul class="pager hidden-print">
      <li class="previous">
        <a rel="prev" href="../psr-11/"><i class="fa fa-arrow-left"></i> Previous</a>
      </li>
      <li class="next">
        <a rel="next" href="../injector/">Next <i class="fa fa-arrow-right"></i></a>
      </li>
    </ul>
    
</div></div>
        <div class="col-md-9" role="main">

<ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="..">zend-di</a></li>
  
    
      
        <li>Reference</li>
      
    
  
  <li class="active">Configuration</li>
</ol>

<h1 id="configuration">Configuration</h1>
<p>Configuration detailing how types are constructed and dependencies should be
resolved can be provided as an associative array when instantiating
<code>Zend\Di\Config</code>. A type may be an actual class name or an alias to a class
name.</p>
<p>The configuration array respects the following keys (unknown keys are ignored):</p>
<ul>
<li>
<p><code>preferences</code>: Associative nested array that maps class or interface names to
  a service name that should be used to provide a dependency. See the
  <a href="#type-preferences">Type Preferences</a> section below for details.</p>
</li>
<li>
<p><code>types</code>: Associative array defining how classes or aliases should be
  constructed. Each key in this array is a class or alias name, and its value is
  another associative array with the following keys:</p>
</li>
<li>
<p><code>preferences</code>: The same as <code>preferences</code> above, but only for the associated
    class.</p>
</li>
<li>
<p><code>parameters</code>: Associative array declaring the values to inject for the
    declared construction parameters.  Each key is the parameter name as
    declared in the constructor method of the associated class name. See the
    <a href="#parameters">Parameters</a> section below for details.</p>
</li>
<li>
<p><code>typeOf</code>: String that contains a class name. It declares that the
    associated key is an alias of the given class name. This class must exist.
    It cannot not be another alias.</p>
</li>
</ul>
<p>Below is an example of injector configuration.</p>
<pre class="codehilite"><code class="language-php">$config = new \Zend\Di\Config([
    // Declares global preferences to use when resolving
    // dependencies of the specified type
    'preferences' =&gt; [
        // A map of classname =&gt; preferred type
        MyInterface::class =&gt; MyImplementation::class,
    ],

    // Declares how types should be constructed.
    // This also allows declaring aliases of a specific class
    'types' =&gt; [
        ClassName::class =&gt; [
            // Declaration in the same way as global preferences
            // but these will aply when the type of the associated key
            // should be instanciated
            'preferences' =&gt; [],

            // Constructor parameters to inject. This option will define
            // the injections directly by the parameter name of the constructor
            // used as key.
            //
            // If the parameter is type-hinted by a class/interface name, you can
            // provide the injection by string. The injector will use the IoC
            // container to obtain it.
            'parameters' =&gt; [
                'foo' =&gt; 'bar',
            ],
        ],

        // Define an alias
        'Alias.Name' =&gt; [
            'typeOf' =&gt; ClassName::class,

            'preferences' =&gt; [],
            'parameters' =&gt; [],
        ],
    ],
]);</code></pre>

<h2 id="type-preferences">Type Preferences</h2>
<p>In many cases, you might be using interfaces as type hints as opposed to
concrete types. Even though type preferences are not limited to interfaces or
abstract class names, they provide hints to the injector on how such types
should be resolved.</p>
<p>The resolver will look up the name finally passed to the container in the
following way (the first match will be used):</p>
<ol>
<li>The preference defined in the type configuration of  the class if it satifies
   the typehint (implements, extends, or typeOf).</li>
<li>If there is a global preference defined and it satisfies the typehint.</li>
<li>Use the typehinted name directly.</li>
</ol>
<pre class="codehilite"><code class="language-php">// Assume the following classes are declared:

interface FooInterface
{}

class Foo implements FooInterface
{}

class SpecialFoo implements FooInterface
{}

class Bar
{}

class MyClass
{
    public function __construct(FooInterface $foo)
    {
        // ...
    }
}

// With the following configuration:

use Zend\Di\Injector;
use Zend\Di\Config;

$injector = new Injector(new Config([
    'preferences' =&gt; [
        FooInterface::class =&gt; Foo::class,
    ],
    'types' =&gt; [
        'MyClass.A' =&gt; [
            'typeOf' =&gt; MyClass::class
            'preferences' =&gt; [
               FooInterface::class =&gt; SpecialFoo::class,,
            ],
        ],
        'MyClass.B' =&gt; [
            'typeOf' =&gt; MyClass::class
            'preferences' =&gt; [
               FooInterface::class =&gt; Bar::class,,
            ],
        ],
    ],
]);


// The results are:
$a = $injector-&gt;create(MyClass::class); // Constructed with Foo
$b = $injector-&gt;create('MyClass.A'); // Constructed with SpecialFoo
$c = $injector-&gt;create('MyClass.B'); // Constructed with Foo (since Bar does not satisfy FooInterface)</code></pre>

<h2 id="parameters">Parameters</h2>
<p>In contrast to type preferences, the resolver will not perform checks if the
provided value satisfies the required type. It will be used directly to inject
the value.</p>
<p>There are several ways to define injections.</p>
<ul>
<li>
<p>An IoC container service name as string: This is only possible if the required
  type is a class or interface. For other types (scalars, <code>iterable</code>,
  <code>callable</code>, etc) or typeless parameters, the string value is passed <strong>as is</strong>.</p>
</li>
<li>
<p>An instance of <code>Zend\Di\Resolver\ValueInjection</code>: Injects the value returned
  by <code>getValue()</code> as is.</p>
</li>
<li>
<p>An instance of <code>Zend\Di\Resolver\TypeInjection</code>: Obtains the injected value
  from the IoC container by passing the return value of <code>getType()</code> to the
  container's <code>get()</code> method.</p>
</li>
<li>
<p>The string literal <code>'*'</code>: This requests the injector to ignore any previously
  defined parameter and use the type preference resolution as described in
  <a href="#type-preferences">Type Preferences</a>.</p>
</li>
<li>
<p>Any other value will be used as is and encapsulated in a
  <code>Zend\Di\Resolver\ValueInjection</code>. If the provided value's type does not fit
  the required parameter type, an exception is thrown.</p>
</li>
</ul>
<h2 id="aliases">Aliases</h2>
<p>Aliases allow you to configure the same class with different construction
options. Aliases can directly be created with the injector or declared as type
preferences.</p>
<p>An alias must refer to an actual class or an interface, therefore you cannot
declare aliases for another alias.</p>
<p>For example the following the following class should be instantiated in two
different ways:</p>
<pre class="codehilite"><code class="language-php">// Assume the following classes are declared:

class Foo
{}

class SpecialFoo extends Foo
{}

class MyClass
{
    public function __construct(Foo $foo, string $bar)
    {
        // ...
    }
}

// With the following injection config:

use Zend\Di\Injector;
use Zend\Di\Config;

$injector = new Injector(new Config([
    'types' =&gt; [
        MyClass::class =&gt; [
            'parameters' =&gt; [
               'foo' =&gt; SpecialFoo::class,
               'bar' =&gt; 'Stringvalue',
            ],
        ],
        'MyClass.Alias' =&gt; [
            'typeOf' =&gt; MyClass::class,
            'parameters' =&gt; [
               'foo' =&gt; '*',
               'bar' =&gt; 'Stringvalue',
            ],
        ],
    ],
]);

// The results are:
$a = $injector-&gt;create(MyClass::class); // Constructed with SpecialFoo
$b = $injector-&gt;create('MyClass.Alias'); // Constructed with Foo (since there are no type preferences for Foo)</code></pre>

<hr />


<nav>
  <ul class="pager hidden-print">
    <li class="previous">
      <a rel="prev" href="../psr-11/"><i class="fa fa-arrow-left"></i> Previous</a>
    </li>
    <li class="next">
      <a rel="next" href="../injector/">Next <i class="fa fa-arrow-right"></i></a>
    </li>
  </ul>
</nav>
</div>
        
    </div>
    <!-- content:end -->

    <div id="footerwrap">
    <div class="container">
        <div class="row site-map">
            <div class="col-lg-3">
              <p>
                <strong>Zend Framework</strong><br />
                <a href="https://framework.zend.com/">framework.zend.com</a><br />
                <a href="https://docs.zendframework.com">docs.zendframework.com</a><br />
                <a href="https://packages.zendframework.com">packages.zendframework.com</a><br />
                <a href="https://apigility.org">apigility.org</a><br />
              </p>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 centered">
                <a class="back-to-top" href="#page-top"><i class="fa fa-chevron-circle-up fa-4" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="spacing"></div>

        <div class="row">
            <div class="col-lg-8">
                <h4>Copyright</h4>
                <div class="hline-w"></div>

                <p>&copy; 2006-2017 by <a href="https://www.zend.com/">Zend</a>, a <a href="https://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            <div class="col-lg-4">
                <h4>Contacts</h4>
                <div class="hline-w"></div>
                <p>
                    <a href="https://discourse.zendframework.com" class="btn-social btn-outline" alt="Forum" title="Forum"><i class="fa fa-comments"></i></a>
                    <a href="https://zendframework-slack.herokuapp.com" class="btn-social btn-outline" alt="Slack" title="Slack"><i class="fa fa-slack"></i></a>
                    <a href="https://github.com/zendframework" class="btn-social btn-outline" alt="Github" title="Github"><i class="fa fa-github"></i></a>
                    <a href="https://twitter.com/zfdevteam" class="btn-social btn-outline" alt="Twitter" title="Twitter"><i class="fa fa-twitter"></i></a>
                </p>
            </div>
        </div>
    </div>
</div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script>var base_url = '..';</script>
    <script src="../js/scripts-0b6185f4a5.js"></script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    <div class="zf-components">
  <div class="zf-components-grid">
    <div class="zf-logo">
      <a href="https://framework.zend.com" data-toggle="tooltip" data-placement="bottom" title="Go to the ZF homepage"><img src="../img/zf-logo-mark.svg" alt="Zend Framework" width="250" /></a>
    </div>

    <div class="component-list"></div>

    <p class="zf-components-rollup"><a href="#">Hide list</a></p>
  </div>
</div>

</body>

</html>
